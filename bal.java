This code is modified by dev1
